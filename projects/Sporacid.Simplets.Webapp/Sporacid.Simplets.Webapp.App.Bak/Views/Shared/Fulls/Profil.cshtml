@{
  ViewBag.Title = "Profil";
}

<div id="page-wrapper">

  <div class="row">
    <div class="col-lg-6">
      <h1>Votre profil</h1>
      <br/>
    </div>
    <div class="col-lg-6" >
      <h4>Votre niveau</h4>
      <div style="position: relative;">
        <div style="position: absolute; height: 40px; font-size: 30px;">33</div>
        <div class="progress" style="height: 40px; margin-left: 60px; margin-right: 60px;">
          <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
            <h4>Xp: 5174 / 8000</h4>
          </div>
        </div>
        <div style="position: absolute; height: 40px; font-size: 30px; right: 0px; top: 0px;">34</div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div id="profil" class="panel panel-primary" data-bind="with: profil">
        <div class="panel-heading">
          <h3 class="panel-title">Vos informations</h3>
        </div>
        <div class="row" style="padding: 20px;">
          <div class="col-md-4">
            <label>Avatar</label>
            <div class="sets-profil-avatar"></div>
          </div>
          <div class="col-md-8">
            <form role="form">
              <div class="form-group">
                <label>Prenom</label>
                <input data-bind="value: prenom" class="form-control" placeholder="Votre prenom" />
              </div>
              <div class="form-group">
                <label>Nom</label>
                <input data-bind="value: nom" class="form-control" placeholder="Votre nom" />
              </div>
              <div class="form-group">
                <label>Concentration</label>
                <select data-bind="
                      options: $root.concentrations,
                      optionsValue: 'id',
                      optionsText: function (concentration) {
                        return sprintf('%s - %s', concentration.acronyme, concentration.description);
                      },
                      value: concentrationId" class="form-control"></select>
              </div>
              <div class="form-group">
                <label>Rendre vos informations publiques</label>
                <input data-bind="value: public" type="checkbox" class="form-control text-left" style="width: 40px;"/>
                <p class="help-block">Si coché, les utilisateurs de plateforme SimplETS pourront visionner cette section de votre profil.</p>
              </div>
              <button data-bind="click: edit" type="submit" class="btn btn-primary"><i class="metro-icon metro-save-trans"></i>Sauvegarder</button>
              <button data-bind="click: cancelEdit" class="btn btn-default"><i class="metro-icon metro-cancel-trans"></i>Annuler</button>
            </form>
          </div>
        </div>
      </div>

      @*@Html.Partial("Partials/_Profil")*@
    </div>

    <div class="col-md-6">
      @Html.Partial("Partials/_ProfilAvance")
    </div>
  </div>
  
    
  <div class="row">
    <div class="col-md-6">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">Vos formations</h3>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th>Titre</th>
              <th>Description</th>
              <th>Public</th>
              <th class="sets-fixed-width-cell1"></th>
              <th class="sets-fixed-width-cell1"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Chauffer une grue</td>
              <td>Je chauffe des grues dans mes temps libres.</td>
              <td><input type="checkbox" class="form-control text-left" style="width: 40px;" checked></td>
              <td class="sets-fixed-width-cell1"><div class="metro-icon metro-edit"></div></td>
              <td class="sets-fixed-width-cell1"><div class="metro-icon metro-delete"></div></td>
            </tr>
            <tr>
              <td><input class="form-control" placeholder="Titre de la formation" /></td>
              <td><input class="form-control" placeholder="Description de la formation" /></td>
              <td><input type="checkbox" class="form-control text-left" style="width: 40px;"></td>
              <td class="sets-fixed-width-cell1"><div class="metro-icon metro-add"></div></td>
              <td class="sets-fixed-width-cell1"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">Vos allergies</h3>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th>Nom</th>
              <th>Description</th>
              <th>Public</th>
              <th class="sets-fixed-width-cell1"></th>
              <th class="sets-fixed-width-cell1"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Peanut</td>
              <td>Je meurs si je suis en contact avec une peanut.</td>
              <td><input type="checkbox" class="form-control text-left" style="width: 40px;" checked></td>
              <td class="sets-fixed-width-cell1"><div class="metro-icon metro-edit"></div></td>
              <td class="sets-fixed-width-cell1"><div class="metro-icon metro-delete"></div></td>
            </tr>
            <tr>
              <td><input class="form-control" placeholder="Nom de l'allergie" /></td>
              <td><input class="form-control" placeholder="Description" /></td>
              <td><input type="checkbox" class="form-control text-left" style="width: 40px;"></td>
              <td class="sets-fixed-width-cell1"><div class="metro-icon metro-add"></div></td>
              <td class="sets-fixed-width-cell1"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

@section StylesImport {
  <style type="text/css">
    
    .table > tbody > tr > td > .metro-icon {
      height: 40px;
      width: 40px;
      display: inline-block;
      cursor: pointer;
      border-radius: 6px;
    }

    .table .sets-fixed-width-cell1 { width: 40px; }

    .table > tbody > tr > td {
      vertical-align: middle;
      min-width: 40px
    }

    .sets-profil-avatar {
      background-image: url(http://upload.wikimedia.org/wikipedia/en/thumb/f/ff/Polarity_cover.jpg/220px-Polarity_cover.jpg);
      background-size: 100% auto;
      background-repeat: no-repeat;
    }
  </style>
}

@section ScriptsImportBottom {
  <script type="text/javascript">
    jQuery(function($) {
      var $avatar = $(".sets-profil-avatar");
      $avatar.height($avatar.width());

      $(window).on("resize", function() {
        $avatar.height($avatar.width());
      });

      //ko.applyBindings(new ConcentrationsModelView());
      ko.applyBindings(new ProfilModelView());
    });
    
    function ProfilModelView() {
      var self = this;
      self.profil = ko.observable();
      self.concentrations = ko.observableArray();

      restCall(buildUrl(apiUrl, "enumeration/concentrations"), operations.get(), buildKerberosAuthHeader("aj50440", "AOPbgtZXD666")).done(function (concentrations) {
        for (var iConcentration = 0; iConcentration < concentrations.length; iConcentration++) {
          self.concentrations.push(concentrations[iConcentration]);
        }
      });

      restCall(buildUrl(apiUrl, "aj50440", "profil"), operations.get(), buildKerberosAuthHeader("aj50440", "AOPbgtZXD666")).done(function (profil) {
        self.profil(profil);
      });

      self.edit = function() {

      }

      self.cancelEdit = function() {

      }
    }
  </script>
}